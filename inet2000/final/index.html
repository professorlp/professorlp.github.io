<!DOCTYPE html>
<html>
<head>
	<meta charset="utf8">
	<title>Sheridan Campus Room Locator</title>
	<style type="text/css">
		#map-container, #search-container { text-align: center; position: relative; }
		#map { height: 100%; }
		#pin-container { position: absolute; display: none; }
		#caption { background: yellow; padding: 10px; color: #000; border-radius: 4px; position: absolute; }
	</style>
	<script type="text/javascript">
	var newfuckingheight;
	var newfuckingheight;
	//room array
		var rooms = {
                "w166" : { "desc": "classroom", "x": 346, "y": 492 },
                "w167" : { "desc": "classroom", "x": 341, "y": 494 },
                "w168" : { "desc": "TRIO Services", "x": 328, "y": 500 },
                "w168f" : { "desc": "Lillian Sager", "x": 316, "y": 500 },
                "trcc014" : { "desc": "SGA & SCAN", "x": 444, "y": 388 },
                "trcc106" : { "desc": "Campus Life & Housing", "x": 398, "y": 400 },
                "trcc008" : { "desc": "Activities room", "x": 390, "y": 430 },
                "trcc002" : { "desc": "conference", "x": 401, "y": 402 },
                "sva" : { "desc": "Student  Veterans Association", "x": 400, "y": 400 },
                "g160" : { "desc": "Kooi Library", "x": 306, "y": 414 },
                "g130" : { "desc": "I.T. Services", "x": 274, "y": 393 },
                "g141" : { "desc": "Human Resources", "x": 241, "y": 400 },
                "wca125" : { "desc": "back stage", "x": 239, "y": 581 },
                "w145" : { "desc": "Executive Offices", "x": 324, "y": 581 },
                "w159a" : { "desc": "Mark Thoney", "x": 363, "y": 557 },
                "w158" : { "desc": "classroom", "x": 348, "y": 557 },
                "w176" : { "desc": "massage classroom", "x": 418, "y": 572 },
                "sc119" : { "desc": "Science Lab", "x": 573, "y": 616 },
                "sc122" : { "desc": "Science Lab", "x": 591, "y": 608 },
                "sc107" : { "desc": "classroom", "x": 544, "y": 586 },
                "ag201" : { "desc": "classroom", "x": 642, "y": 525 },
                //residence halls:
                "founders" : { "desc": "Founders Hall", "x": 98, "y": 301 },
                "south" : { "desc": "South Hall", "x": 360, "y": 298 },
                "dief" : { "desc": "Diefenderfer House", "x": 147, "y": 351 },
                "davis" : { "desc": "Davis House", "x": 134, "y": 380 },
                "crook" : { "desc": "Crook Hall", "x": 102, "y": 426 },
                "blume" : { "desc": "Blume House", "x": 137, "y": 406 },
                "eaton" : { "desc": "Eaton House", "x": 199, "y": 405 },
                "kearny" : { "desc": "Kearny Hall", "x": 141, "y": 451 },
                "griffen" : { "desc": "Griffen House", "x": 219, "y": 431 },
                //g because of griffith memorial
                "g" : { "desc": "Griffith House", "x": 196, "y": 439 },
                "conner" : { "desc": "Conner hall", "x": 107, "y": 491 },
                "mckeen" : { "desc": "McKeen House", "x": 185, "y": 477 },
                "hanson" : { "desc": "Hanson House", "x": 220, "y": 474 },
                "hayes" : { "desc": "Hayes Loft", "x": 64, "y": 517 },
                "williams" : { "desc": "Williams Loft", "x": 32, "y": 554 },
                "stevens" : { "desc": "Stevens Loft", "x": 67, "y": 542 },
                "fitzgerald" : { "desc": "Fitzgerald Loft", "x": 112, "y": 531 },
                "thorn" : { "desc": "Thorn House", "x": 145, "y": 522 },
                
              };
      //console.log("test1: " + rooms["w166"]["y"]);
		//["W",166,"(classroom)",346,492]} // list of rooms that can be located

		function resizer(){
      newfuckingwidth = $('#map').width();
      newfuckingheight = $('#map').height();
		}
		
		// locate room
		function lookup(room) {
		
		//console.log($('#map-container').width());
		
		//first i need to make sure all entries are in  the same format
		//i wonder if there is a better way to do this..
		room = room.toLowerCase();
		room = room.replace("whitney","w");
		
		//instead of gmb this will become g so griffith house isnt overlooked
		room = room.replace("griffith memorial building","g");
		room = room.replace("gmb","g");
		
		//griffith house
		room = room.replace("griffith","g");
		
		room = room.replace("whitney center for the arts","wca");
		
		room = room.replace("thorne-rider campus center","trcc");
		room = room.replace("thorne-rider","trcc");
		room = room.replace("thorne rider","trcc");
		
		room = room.replace("science center","sc");
		
		room = room.replace("mars agriculture center","ag");
		room = room.replace("agriculture center","ag");
		room = room.replace("mars ag center","ag");
		room = room.replace("ag center","ag");	
		
		room = room.replace("hall","");
		room = room.replace("house","");
		
		//make it so it deletes ALL spaces and -
		room = room.replace(/-/g,"");
		room = room.replace(/ /g, "");
		console.log(room);
		
		if(!rooms[room]){
		alert("sorry, room '" + room + "' was not found! :(");
		}else{
		//make sure it is working
		console.log(rooms[room]["desc"]);
		
		//here we find the percent X the original pin location would be compared to the original image ...
		//then apply it to the scaled image.
		//IT WAS TERRIBLE GETTING THIS TO WORK
	var newLeft= ((rooms[room]["x"]-0)/914)*(newfuckingwidth)-20;
  var newTop= ((rooms[room]["y"]-0)/922)*(newfuckingheight)-70;
  
			// the following gets the top left corner location of the object specified.
			var position = $('#map').offset(); // example: position = { left: 20, top: 45 }
		//console.log(position);
			var css = 'left: ' + (parseInt(position.left) + newLeft) + 'px; ' + 'top: ' + (parseInt(position.top) + newTop) + 'px;'
			$('#pin-container').attr('style', css);
			$('#caption').html(rooms[room]["desc"]);
			$('#pin-container').show();
			//return false;
			}
		}
		
		function adjustMap() {
			// get height of window in pixel so we can adjust the container
			// and leave some space at the bottom of the page for the form.
			//
			
			var windowHeight = $(window).height() - 100;
			$('#map-container').height(windowHeight);
			$('#pin-container').hide();
			
			newfuckingwidth = $('#map').width();
      newfuckingheight = $('#map').height();
		}
	</script>
</head>
<body >
	<div id="map-container">
		<div id="pin-container" >
			<img id="pin" src="pin.png" />
			<div id="caption"></div>
		</div>
		<img id="map" src="map.jpg" />
	</div>
	<div id="search-container">
		
		<!-- removed form -->
			<label>Enter room name or number:</label>
			<input type="text" name="room" id="room">
			<button onclick="lookup($('#room').val());">Locate</button>
		
	</div>

	<script src="slim.js"></script>

	<script>	
		// run when page first loads
	  	$(document).ready( function(){
	  		//Run function when browser  resize
		  	$(window).resize( adjustMap );
	  		adjustMap();
	  		
	  		//bind enter to submit
	  		$(document).keypress(function (e) {
          var key = e.which;
          if(key == 13)  // the enter key code
            {
              lookup($('#room').val());
              //clear the text box for new input  
              $('#room').val("");
            }
         });  
         
	  	});
	</script>	
</body>
</html>

<!-- don't mind the angry variable. i couldnt get the pin to place correctly, so i may have raged for a moment. -->